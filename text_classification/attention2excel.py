#!/usr/bin/env python
# -*- coding: utf-8 -*-

# @author: hongyue.pei
# @file: attention2excel.py
# @time: 2020/5/4 下午5:05
# @desc:


from xlsxwriter.workbook import Workbook
import heapq


def get_top_idx(sentenses, top_s=None):
    sentenses_activation = [i[0] for i in filter(lambda x: len(x[1]) > 0, sentenses)]
    s_len = len(sentenses)
    if not top_s:
        top_s = int(s_len / 10)
    s_index = list(map(sentenses_activation.index, heapq.nlargest(top_s, sentenses_activation)))
    return s_index


def get_sentence(sentence):
    origin_sentence = ''
    for tokens in sentence[1]:
        origin_sentence += tokens[1]
    return origin_sentence


def get_token_pair(sentence, format, word_c=None):
    tokens = []
    if word_c:
        w_top = get_top_idx(sentence[1], 20)
    for i, w in enumerate(sentence[1]):
        if word_c and i in w_top:
            if w[1] == '' or w[1] is None:
                tokens.extend((word_c, '\s'))
            else:
                tokens.extend((word_c, w[1]))
        else:
            if w[1] == '' or w[1] is None:
                tokens.extend((format, '\s'))
            else:
                tokens.extend((format, w[1]))
        if i == (len(sentence[1]) - 1) and w != '。':
            tokens.extend((format, '。'))
    return tokens


def to_excel(target_value, article_with_attention, excel_path):
    workbook = Workbook(excel_path)
    red = workbook.add_format({'color': 'red'})
    blue = workbook.add_format({'color': 'blue'})
    black = workbook.add_format({'color': 'black'})
    worksheet = workbook._add_sheet('Sheet 1')
    for row_num, sentences in enumerate(article_with_attention):
        s_idx = get_top_idx(sentences)
        tokens_pair = []
        for idx, sentence in enumerate(sentences):
            if idx in s_idx:
                tokens_pair.extend(get_token_pair(sentence, red, blue))
            else:
                tokens_pair.extend(get_token_pair(sentence, black))
        for i in tokens_pair:
            print(i)
        worksheet._write_rich_string(row_num, 1, *tokens_pair)
        worksheet.write(row_num, 0, *target_value)
    workbook.close()


if __name__ == '__main__':
    article_with_attention = [[(0.031608474, [(0.05723032173598643, '外院'), (0.07909761756437503, '行左乳'), (0.012353226389640213, '肿物'), (0.009589578060029823, '穿刺'), (0.0001694734343788024, '，'), (0.008461230796181298, '病理'), (0.02392182922139102, '提示'), (0.0008096775362708062, '：'), (0.004329171102497765, '左乳'), (0.006794695411036635, '浸润性'), (0.015114061769127598, '导管'), (0.0057162234274586755, '癌'), (0.000161040593302937, '，'), (0.011988711497549764, 'ER'), (0.014398714077127986, '约'), (0.14795315155982536, '100%'), (0.0011802442873366365, '（'), (0.003452786906853054, '+'), (0.0015215074882159315, '）'), (0.0002665768011329528, '，'), (0.020656464589466107, 'PR'), (0.01856886816571327, '约'), (0.014300713689831513, '90%'), (0.0011890629918025857, '（'), (0.0035027908360744492, '+'), (0.0015531472178840291, '）'), (0.0002743081406960878, '，'), (0.5285787702579315, 'Her2'), (0.0011192990377692491, '（'), (0.00315235009246581, '2'), (0.0019611694758349912, '+'), (0.0006332158448116935, '）')]), (0.035223898, [(0.03489809198340417, '全身'), (0.07553589911269866, '骨'), (0.05723590582995898, '扫描'), (0.030692488632993276, '提示'), (0.0010786551184995125, '：'), (0.22312651821841367, '股骨'), (0.5146525911153872, '远端'), (0.002929760329921305, '1'), (0.0009082338947035876, '/'), (0.0028405313170776283, '3'), (0.00987213132346348, '代谢'), (0.02799589883534073, '活跃'), (0.0037662168463976214, '灶'), (6.602828644726546e-05, '，'), (0.0010648919970758966, '考虑'), (0.0012755422249090898, '转移'), (0.005899709799108692, '瘤'), (0.006160905134199202, '可能')]), (0.046253327, [(0.0012161566583649818, '我院'), (0.0015880194979579147, '行'), (0.0014531631573373568, '病理'), (0.009862410992326437, '会诊'), (0.0008642154796298268, '示'), (0.00012536084365356046, '：'), (0.001068892351541654, '浸润性'), (0.002126817449139367, '导管'), (0.0006648892143539543, '癌'), (9.206613936955649e-05, '（'), (0.0033902743064314613, 'II'), (0.002015983274808898, '级'), (0.00011316203678781667, '）'), (2.0151326564854738e-05, '，'), (0.0013834516485265495, 'ER'), (6.322868840477195e-05, ''), (0.016991518372578736, '100%'), (0.031097188368791884, '强'), (0.00016887769482182454, '（'), (0.0004982595006346569, '+'), (0.00021561433078128107, '）'), (3.8904345131441816e-05, '，'), (0.14895152309255946, 'PR90%'), (0.04286352726474416, '强'), (0.0001861818784460046, '（'), (0.00047887899372159304, '+'), (0.0001747687009184085, '）'), (2.6567457342782245e-05, '，'), (0.02291573618959319, 'CerbB2'), (0.00010180252064882677, '（'), (0.000327302107546573, '2'), (0.00022930777719607412, '+'), (7.985829372810196e-05, '）'), (2.8646009319398473e-05, '、'), (0.0015097730415594755, 'Ki67'), (2.6394007277094415e-05, ''), (0.01923544729893615, '12%'), (7.026689271998487e-06, '，'), (0.002210417856144941, 'FISH'), (3.864583426695141e-05, '（'), (1.3918554211165747e-05, '-'), (5.377403693233758e-05, '）'), (9.318261796533072e-06, '，'), (0.00016175712207909792, '考虑'), (0.00016388323380092475, '患者'), (0.00037243011202904076, '左'), (0.0006043157583932153, '乳癌'), (0.0025905026705488224, '并'), (0.0012606991869559758, '双肺'), (0.0002013330839499511, '转移'), (2.0270946587025764e-05, '、'), (0.00046828378546359743, '骨转移'), (0.0004973592207218158, '诊断'), (0.023412698022701923, '较为'), (0.0005135696530564558, '明确'), (5.1755978042684376e-06, '，'), (0.009287732471383037, '咳血'), (0.021355785807202217, '丝痰'), (0.00014333722092030015, '考虑'), (0.0025960124094351147, '肿瘤'), (0.001227942131742144, '侵犯'), (0.008050871806190291, '肺部'), (0.014159455466914887, '所致'), (7.326826423423695e-06, '，'), (0.0015577128644699756, '予'), (0.0015775664042469643, '相关'), (0.005524548197051383, '止咳'), (1.0325243423099635e-05, '、'), (0.006250768069660656, '化痰'), (1.2756582949865273e-05, '、'), (0.008849292066414209, '止血'), (0.0001336951529703742, '治疗'), (6.151001030329581e-06, '，'), (0.010519169264649368, '咳血'), (0.023739351264539753, '丝痰'), (0.0030867619798487433, '症状'), (0.003708754580159336, '逐渐'), (0.002893074388963848, '缓解'), (1.4974781192467354e-05, '，'), (0.0006150546329173921, '于'), (0.0011267224864576107, '2016'), (3.494102426112881e-05, '-'), (0.001879990747866939, '03'), (4.409674782375333e-05, '-'), (0.02458440788269442, '31'), (0.07827631991205508, '起予'), (0.0014658433156533826, '“'), (0.008439879751652803, 'CTX'), (6.417607800320153e-05, ''), (0.016561921393250387, '1g'), (0.00039464085505012454, '+'), (0.07995410398393711, '法码'), (0.014228973238682276, '新'), (0.061946918367765995, '160mg'), (0.0015073060308144295, '方案'), (0.0018007992874679423, '”'), (0.0003309791266056209, '化疗'), (0.00046285370102315136, '1'), (0.0009902988371621178, '次'), (1.5467346550037076e-05, '，'), (0.0002444631037052459, '化疗'), (0.00018131427974282452, '后'), (0.001239080320256734, '出现'), (0.0018045603582150741, 'IV'), (0.003151385519061011, '度'), (0.005161985323485718, '骨髓'), (0.004142398048369515, '抑制'), (2.973641264453608e-05, '，'), (0.0011774400754770878, '于'), (0.002096309119411644, '2016'), (6.349823747477688e-05, '-'), (0.011429191772693208, '04'), (5.724602799498311e-05, '-'), (0.003918087764224405, '21'), (0.005137971184981457, '予以'), (0.03665252897973461, '第二'), (0.0014635732581398265, '程'), (0.014334494969365673, 'EC'), (0.012798336296429942, '减量'), (0.00021344299793303197, '化疗'), (1.0371756474324614e-05, '，'), (0.00728480835770862, '法玛新'), (2.547406285938319e-05, ''), (0.0323634775950424, '145mg'), (0.00011992777181317966, '+'), (0.003930613648866934, 'CTX'), (2.954189715770119e-05, ''), (0.007719919262229411, '1g'), (1.2743309479546607e-05, '，'), (0.000887749578339823, '2016'), (2.907547894876621e-05, '-'), (0.003562722631479306, '05'), (0.015906475517805503, '全面'), (0.012564447750386855, '评估'), (0.002595645775269825, '提示'), (8.248127127282367e-05, '：'), (0.001776553155912797, '肺'), (2.3721073584100732e-05, '、'), (0.0009603158519778502, '胸膜'), (1.7585894639382475e-05, '、'), (0.00012405793467126224, '乳腺'), (0.0004643269960952962, '肿物'), (1.5344573291765715e-05, '、'), (0.00026019668072281284, '腋窝'), (0.00013724577574421307, '及'), (0.002866723144867515, '肺门'), (0.00027570097350346293, '淋巴结'), (0.0005982420497004018, '较前'), (0.0017626837624940155, '稍'), (0.002114800746356326, '缩小'), (1.0587305906320459e-05, '，'), (0.012128294745025449, 'L2'), (1.9808185699759607e-05, '、'), (0.008897097732329762, 'L4'), (0.00010314554741968103, '及'), (0.003753776342383517, 'L5'), (0.0006906798979158731, '椎体'), (0.0004433838373089727, '异常'), (0.0017408967374530778, '信号'), (6.415318039778878e-05, '及'), (0.0003711791473498382, '异常'), (0.0014696514448789015, '强化'), (0.0002081024485793235, '灶'), (0.0011881504120870585, '较'), (0.000434342288188028, '前'), (0.0004179717513709123, '相仿')]), (0.03382824, [(0.004970538819674457, '于'), (0.00818025289749779, '2016'), (0.000223877860685495, '-'), (0.023884903921985928, '05'), (0.00020277161880937765, '-'), (0.015582743520187108, '17'), (0.019369944449388245, '予以'), (0.10186009978273847, '第三'), (0.007616792106338296, '程'), (0.09108792530822829, 'EC'), (0.001919237825911782, '化疗'), (0.00011616324601426623, '，'), (0.0019200362496241698, '化疗'), (0.0015034069413859858, '后'), (0.011672786224018667, '第'), (0.02664697001374561, '13'), (0.023127605119044724, '天'), (0.010048495356418921, '出现'), (0.09922694103879494, '气促'), (0.00024171794167874007, '、'), (0.1344928498708661, '呼吸困难'), (0.0002104585783950333, '、'), (0.12045804245559522, '头痛'), (0.00016781522754749696, '、'), (0.03757687575683044, '头晕'), (4.608088185242799e-05, '，'), (0.004246834310671264, '第'), (0.0042608795669749995, '14'), (0.005614694090420373, '天'), (0.002200624832574558, '出现'), (0.07865461032560193, '数次'), (0.014130875085429906, '痰'), (0.00280664567686864, '中'), (0.020728975517156255, '带'), (0.012594269891573147, '血'), (1.986152423607857e-05, '，'), (0.004853845770042543, '予以'), (0.04057005196766908, '止血'), (0.009690696480687676, '药物'), (0.00040911806488319597, '后'), (0.006831553852815473, '好转'), (3.5728814773119295e-05, '，'), (0.0017111581952629032, '行'), (0.00841237632709817, '病情'), (0.026126902986082275, '评估'), (0.000854229332043367, '为'), (0.012890734373877066, 'PD')]), (0.029799398, [(0.013023500587635076, '经'), (0.09359100772523513, 'MDT'), (0.06882982150971437, '讨论'), (0.0014363141991781316, '后'), (0.28160150058833755, '更改'), (0.0019122600226041747, '化疗'), (0.006887572235330777, '方案'), (0.002545337238076822, '为'), (0.3654831677770221, '单周'), (0.007382912880830295, '“'), (0.03278466540450331, '紫杉醇'), (0.00146647579254929, '+'), (0.04341670344000614, '氟维司'), (0.03396107928575703, '群'), (0.0055401820449144075, '”'), (0.039559595064425065, '姑息'), (0.0005779042038803027, '化疗')]), (0.050793517, [(0.009830445258774237, '2016'), (0.00031633316955194987, '-'), (0.006690173888462042, '6'), (0.00046509362524921853, '-'), (0.02304522035054086, '7'), (0.1053036039165205, '开始'), (0.04837603476613414, '给予'), (0.12548827436094542, '氟维司'), (0.09864592797760337, '群'), (0.1980240137080292, '500mg'), (0.0025038215059342513, '+'), (0.03859586931319455, '紫杉醇'), (0.08053704513794765, '130mg'), (0.00024734379304229564, ''), (0.12455469535287282, 'qw'), (0.0013882298192751281, '治疗'), (5.697032400864844e-05, '，'), (0.0149339342809514, '目前'), (0.028306353068845727, '已'), (0.007710103879427634, '给予'), (0.01217648763630895, '紫杉醇'), (0.0011128627097656085, '6'), (0.002143499825932726, '次'), (3.613170839369551e-05, '，'), (0.016870153508318896, '氟维司'), (0.014043216828641467, '群'), (0.0009548843166941733, '3'), (0.0016949018048675866, '次'), (0.0005409334000227938, '治疗'), (2.0105364957150534e-05, '，'), (0.034382190451233585, '现返院'), (0.001005144947552332, '复查')]), (0.01686377, [(0.012616621000647853, '患者'), (0.10896421092727147, '精神'), (0.0016455271121578086, '、'), (0.447802728393122, '胃纳'), (0.001246312189026011, '、'), (0.10001204010435358, '睡眠'), (0.15424203563005442, '尚可'), (0.00035168440533456756, '，'), (0.12982070220557748, '大小便'), (0.01136797524663316, '正常'), (0.0001870878620167514, '，'), (0.01989925725102913, '体重'), (0.0010982247032422252, '无'), (0.0027406887037573486, '明显'), (0.008004904265776117, '变化')]), (0.018397225, [(0.004929538428886254, '入院'), (0.0007561392395175787, '后'), (0.011523636305506006, '完善'), (0.004832957612078502, '检查'), (6.465933412766972e-05, '，'), (0.0035961622959403564, '2016'), (9.148692190708629e-05, '-'), (0.003326247972318828, '7'), (6.769597438185705e-05, '-'), (0.008748506285998508, '22'), (9.578287086468467e-05, ''), (0.0004976496147725859, '乳腺'), (0.007864649223721258, '肿瘤'), (0.04931046980955647, '系列'), (0.00010429885090020062, '：'), (0.008154744556602691, '癌胚抗原'), (0.03975217167159313, '16.4'), (0.0071974311190209275, 'ng'), (9.663131365179015e-05, '/'), (0.0038424450345528063, 'ml'), (0.00013628099723286968, '；'), (0.0023204307738888034, '糖类'), (0.0020659097698188353, '抗原'), (0.00444146826533852, '125'), (2.3062046362065968e-05, ''), (0.02367931944974479, '52.6'), (0.0019606162610196153, 'U'), (6.862149584180153e-05, '/'), (0.0028469768550759464, 'ml'), (0.0001130884168367237, '；'), (0.002119908863301251, '糖类'), (0.002060273306815131, '抗原'), (0.0008248827200013151, '15'), (1.4416658964330755e-05, '-'), (0.0002746368429898428, '3'), (3.483946712597006e-05, ''), (0.05754191155620229, '85.1'), (0.003115829247649839, 'U'), (0.0001033538943506583, '/'), (0.004530407431588856, 'ml'), (0.00017285253835734753, '；'), (0.0017328921844016513, '细胞'), (0.04786636886479542, '角蛋白'), (0.0019331195880495473, '19'), (0.05341078119652328, '片段'), (0.051721124995937444, '4.27'), (0.0061679080361221154, 'ng'), (9.535836044367123e-05, '/'), (0.004189132838086181, 'ml'), (0.00016392578807896785, '；'), (0.012897204189690327, '血清'), (0.007179215954120689, '钾'), (0.0513088341126984, '4.12'), (0.0017506597969694255, 'mmol'), (6.717543324893135e-05, '/'), (0.00016578069406496365, 'L'), (0.00011852050230083825, '；'), (0.010474821473903724, '血清'), (0.007500762699969605, '钠'), (0.04978234776358702, '138.6'), (0.0016891323824702665, 'mmol'), (6.807559455633334e-05, '/'), (0.00017646362671110892, 'L'), (0.00013234157635991762, '；'), (0.012150286654981923, '血清'), (0.013987544994208463, '氯'), (0.03200755625145838, '105.6'), (0.0016550250245784646, 'mmol'), (6.371369046886315e-05, '/'), (0.0001569347778092771, 'L'), (0.00011100878229886973, '；'), (0.009703935048434868, '血清'), (0.007415493229081141, '钙'), (0.039129964927644284, '2.51'), (0.0013793891989824125, 'mmol'), (5.564975205808372e-05, '/'), (0.00014194359781946207, 'L'), (0.00010135201187948409, '；'), (0.005390376039715589, '尿素'), (0.03783489847304212, '5.9'), (0.001239876932945682, 'mmol'), (4.9325801110639224e-05, '/'), (0.00012329093165051378, 'L'), (8.52256762031932e-05, '；'), (0.004202773847033668, '肌酐'), (0.004446474445757218, '70'), (0.0021186950670562714, 'μ'), (0.0033963658897742588, 'mol'), (4.254939038530323e-05, '/'), (0.00011483356665164861, 'L'), (8.34844613767178e-05, '；'), (1.7065780298205712e-05, ''), (0.012703053591749164, '血细胞'), (0.006387594034927538, '分析'), (7.553408667237716e-05, '('), (0.01894160711812309, '静脉血'), (7.208035771389328e-05, ')'), (3.448946223054121e-05, '：'), (0.0013880674826561104, '白细胞'), (0.0010047985286714958, '计数'), (0.03290690125331762, '6.19'), (4.5290944306822565e-05, '*'), (0.0003028337351618685, '10'), (0.0005257993963048216, '^'), (0.0002738592102579996, '9'), (4.137603256111203e-05, '/'), (0.00010433581931884755, 'L'), (7.021295764614955e-05, '；'), (0.0021642273512999253, '红细胞'), (0.0007378312367556577, '计数'), (0.013491568736702887, '3.66'), (3.361508458119706e-05, '*'), (0.00022549131138405797, '10'), (0.00043003725998247915, '^'), (0.0001572409582469302, '12'), (3.458455795199895e-05, '/'), (9.164004223293997e-05, 'L'), (6.307712805977629e-05, '；'), (1.222814386811238e-05, ''), (0.0012879269385775774, '血红蛋白'), (0.023750198229983414, '107g'), (4.142922097337889e-05, '/'), (0.00011714955272645621, 'L'), (8.888116272085897e-05, '；'), (0.0018781110424094896, '血小板'), (0.0009049333877875815, '计数'), (0.033911510174789786, '276'), (4.765498822194684e-05, '*'), (0.00034338832357973996, '10'), (0.000644320714004312, '^'), (0.0003921055877420446, '9'), (6.547096873241725e-05, '/'), (0.0001877039909650787, 'L'), (0.00015463641538460005, '；'), (0.0026207905992410886, '胸部'), (0.0004219291515521567, 'CT'), (0.0004940443732034986, '示'), (7.835403594738987e-05, '：'), (0.0005449813645843372, '左'), (0.0009443672379379766, '乳癌'), (0.0002478756104292367, '化疗'), (0.0001983104959192166, '后'), (0.00098176092101968, '复查'), (1.1864654871525914e-05, '，'), (0.045026147594410565, '现见'), (0.00029856197084466337, '左乳'), (0.004101761476207297, '内侧'), (0.00039297887217178037, '肿块'), (9.307386732283813e-06, '，'), (0.00020702923005651338, '考虑'), (0.0009269726186534789, '乳腺癌'), (1.9890622299654066e-05, '，'), (0.005613517488263359, '对比'), (0.001807037621912903, '2016'), (5.967605645905245e-05, '-'), (0.007638946866091094, '06'), (6.363628931631102e-05, '-'), (0.00739917150448548, '02'), (9.776258854246538e-05, ''), (0.001062973018393239, 'CT'), (0.00839083278017299, '片'), (2.043543772500943e-05, '，'), (0.00070992268075355, '肿块'), (0.0005637989710980013, '较前'), (0.001811190767219287, '缩小')]), (0.022746738, [(0.012788775773677954, '右乳'), (0.8686353771611872, '两小'), (0.0042887144577687325, '结节'), (0.0262647135281162, '影'), (0.00020311584707077043, '，'), (0.041788455815820295, '同'), (0.022811778073708603, '前'), (0.02321906934265025, '相仿')]), (0.03020359, [(0.059690613800290525, '双侧'), (0.052667876370472745, '腋窝'), (0.07951830108799818, '小'), (0.02782853189328992, '淋巴结'), (0.17943051686760086, '影'), (0.001387351882333524, '，'), (0.28527803980414096, '同'), (0.15563550580376964, '前'), (0.15856326249010366, '相仿')]), (0.029689442, [(0.002735230305579189, '双肺'), (0.010637868847069252, '实质'), (0.04508269964298404, '内及'), (0.0026337849322535106, '胸膜'), (0.008560907717940812, '处'), (0.01908249478811342, '多发病'), (0.0023314047082041178, '灶'), (5.802526984343365e-05, '，'), (0.0012606718983182276, '考虑'), (0.1630240409268202, '肺内'), (0.001639113773544867, '及'), (0.1701405170931459, '淋巴'), (0.3207525562687197, '道'), (0.005017021047754188, '多发'), (0.0028578932641162786, '转移'), (0.00013873736944593055, '，'), (0.03211540155477732, '对比'), (0.009342961726328331, '2016'), (0.000282030158511006, '-'), (0.03370379577304159, '06'), (0.00027373878087325607, '-'), (0.03118884683527004, '02'), (0.0004164306519229319, ''), (0.004954114583115089, 'CT'), (0.040960316912562224, '片'), (0.00011054205026342618, '，'), (0.02267147730273837, '病灶'), (0.0032390753946525026, '较前'), (0.02310286156125894, '减少'), (7.957922698255709e-05, '、'), (0.04160585963384936, '减小')]), (0.018890167, [(0.004342090386582896, ''), (0.14045251666991543, '纵隔'), (0.020854240334159495, '及'), (0.0476144672461889, '双侧'), (0.3728687964476078, '肺门'), (0.058003156109486205, '多发'), (0.10807239367348892, '肿大'), (0.030012598013317075, '淋巴结'), (0.0013153986172437268, '，'), (0.05316158592078455, '较前'), (0.16330275658122503, '缩小')]), (0.01839276, [(0.018915982570919285, '腹部'), (0.048619414015002825, 'MR'), (0.0037734707522138586, '示'), (0.0004926873560374568, '：'), (0.02214948357851222, '扫描'), (0.07142682895592005, '层面'), (0.09309108606728632, 'L2'), (0.00018878290378052137, '、'), (0.09193285825745784, 'L3'), (0.001269643606255275, '及'), (0.053628296281138736, 'L5'), (0.01168951498000085, '椎体'), (0.008454682777718029, '异常'), (0.03826302500869438, '信号'), (0.0016562077859673143, '及'), (0.010917607788815153, '异常'), (0.05191792736960547, '强化'), (0.009010673171897129, '灶'), (0.00021610996815843819, '，'), (0.004582083921376937, '考虑'), (0.012604724381222265, '多发'), (0.024483464921047384, '骨转移'), (0.03594184168134494, '瘤'), (0.0003367541125768229, '，'), (0.06438962196252603, '同'), (0.03579589383223303, '前'), (0.0010313129409234305, '（'), (0.009631922609824853, '2016'), (0.00022460586328043816, '-'), (0.02003591652959348, '05'), (0.00014405214032069583, '-'), (0.24823167501936075, '15MR'), (0.0002560187827507952, '）'), (0.0046958281062370105, '相仿')]), (0.019061986, [(0.005396503168622076, '不'), (0.029667705839293793, '均匀'), (0.03018005098187291, '轻度'), (0.0381351651965106, '脂肪肝'), (0.0018767776987403384, '；'), (0.009644794695302158, '肝'), (0.11300168663070988, 'S5'), (0.024885889025289726, '段'), (0.009249772329001213, '异常'), (0.03399334400482566, '强化'), (0.0020988416325005217, '结节'), (0.00010031986317414056, '，'), (0.5450051195749166, '拟肝岛'), (0.00011970079127369649, '，'), (0.015234662300114329, '建议'), (0.03217362933689393, '定期'), (0.00810396234890561, '复查'), (0.05306111695096927, '以'), (0.023443036843613957, '除外'), (0.0021556648916502804, '转移'), (0.01015063023645861, '瘤'), (0.012321625659360654, '可能')]), (0.022645451, [(0.11014487972115905, '上'), (0.16240158707786154, '腹部'), (0.38045520585855364, 'MR'), (0.052754320395072406, '检查'), (0.0005477424692914057, '，'), (0.11731019845909438, '胆囊'), (0.0005947678025177501, '、'), (0.10333544451754864, '胰腺'), (0.0003934742369726611, '、'), (0.03897275926304599, '脾脏'), (0.003708476908402245, '未见'), (0.016216587731003526, '明确'), (0.0131645555594768, '异常')]), (0.02582335, [(0.005680369368300481, '右侧'), (0.23135121398614744, '股骨'), (0.21092388883086483, '下段'), (0.27505972659721656, '髓'), (0.09002728233706586, '腔'), (0.019179415466952128, '内'), (0.011991748811196141, '异常'), (0.056127643950555244, '信号'), (0.007157920680651394, '灶'), (0.0001439052629239429, '，'), (0.030493069500845092, '同'), (0.017077512454993414, '前'), (0.017909678531495263, '相仿'), (9.872432815016833e-05, '，'), (0.00637405973353313, '结合'), (0.005252744555315264, '病史'), (9.335643812704748e-05, '，'), (0.0018933375983957307, '考虑'), (0.002322603282725634, '转移'), (0.010841798284545248, '瘤')]), (0.027606262, [(0.014780544308627694, '心电图'), (0.0014206050443233138, '示'), (0.00022041223108156482, '：'), (0.037737095425040446, '窦性心'), (0.033202880838950705, '律'), (3.3472968565959655e-05, '，'), (0.17769752522408497, '完全性'), (0.1178471863326584, '右束'), (0.07375033586393463, '支'), (0.11590248484559722, '阻滞'), (3.916473720755592e-05, '，'), (0.015038666210510837, 'III'), (0.006272402383055841, '见'), (0.1708476874240731, 'q'), (0.029709655099891572, '波'), (0.01612756617587769, '>'), (0.03149954599244042, 'R'), (0.0002557095197370274, '/'), (0.0012509022131680738, '4'), (0.00012227588835904426, '：'), (0.022161909185293493, '心脏'), (0.0019260222185511994, '彩超'), (0.0005725028587843633, '示'), (8.335201836397013e-05, '：'), (0.02495595787591828, '探及'), (0.04145937574474721, '肺动脉瓣'), (0.06508476137115544, '返流束')]), (0.030818136, [(0.08610013186090915, '二尖瓣'), (0.195005683669029, '环处'), (0.19277373472501289, 'TDI'), (0.17425419703268247, '频谱'), (0.02031376903314655, '显示'), (0.0017972941698997994, ':'), (0.16537614940229303, 'Ea'), (0.03258519993562112, '＜'), (0.131793840171406, 'Aa')]), (0.033061195, [(0.31355413231256796, '肺动脉瓣'), (0.17777286191438957, '轻微'), (0.3486598781646144, '返流'), (0.000992261028035056, '；'), (0.06601995587355432, '左室'), (0.0705869026283902, '收缩'), (0.0209473391860347, '功能'), (0.0014666688924137937, '正常')]), (0.026813641, [(0.008258775553744175, '入院'), (0.0012287301329009096, '后'), (0.0643194160378625, '评估'), (0.018047790902644596, '疗效'), (0.006965561388433225, '稳定'), (7.033125125704791e-05, '，'), (0.0023163008190634007, '可'), (0.04542162181148185, '继续'), (0.026600781950999335, '予以'), (0.009693036314801545, '“'), (0.06696261752834264, '氟维司'), (0.06070097952363609, '群'), (0.13443769346570633, '500mg'), (0.00040463773795675707, ''), (0.37445718184939575, 'q28d'), (0.001599657460202412, '+'), (0.026130729189049257, '紫杉醇'), (0.05761349667387652, '130mg'), (0.00018029365614750942, ''), (0.0904727137610654, 'qw'), (0.003277041546867422, '”'), (0.0007543806302273612, '治疗'), (8.623081433796798e-05, '。')]), (0.029013239, []), (0.03213034, []), (0.03457946, []), (0.03675561, []), (0.038976427, []), (0.041517504, []), (0.04468457, []), (0.048979122, []), (0.05568543, []), (0.069157705, [])]]
    target_value = [1]
    to_excel(target_value, article_with_attention, 'test.xlsx')




